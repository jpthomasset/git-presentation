<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>GIT - Do's &amp; Don'ts</title>


		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">


                <link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

                <!-- Printing and PDF exports -->
		<script>
		 var link = document.createElement( 'link' );
		 link.rel = 'stylesheet';
		 link.type = 'text/css';
		 link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
		 document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>GIT</h1>
					<h3>Do's and Don'ts</h3>
					<aside class="notes">
						Barre de progression
					</aside>
				</section>

				<section>
					<section>
						<h2>Quelques rappels</h2>
						<p>
							WTF ! C'est quoi ce truc...
						</p>
						<aside class="notes">
						Git est composé de trois espaces
						</aside>
					</section>
					<section>
						<h2>Un espace de travail</h2>
						<h3>workspace</h3>
						<p>C'est l'endroit où vous éditez vos sources</p>
					</section>

					<section>
						<h2>Un dépôt</h2>
						<h3>repository</h3>
						<p>
							Un arbre de toutes les versions organisés autour de commits.
						</p>
						<img width="656" height="325" src="img/basic-tree.png">
						<aside class="notes">
						Chaque commit fait référence à son prédecesseur dans l'arbre, son parent direct.
						</aside>
					</section>

					<section>
						<h2>Qui contient tous les fichiers ?</h2>
						<p>
							Ce n'est pas une suite de 'diff' des différents fichiers mais bien un snapshot de l'intégralité
						</p>
						<img width="656" height="262" src="img/snapshots.png">
						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>Une zone tampon</h2>
						<h3>index ou staging area</h3>
						<p>C'est là ou se trouve vos <strong>modifications</strong> quand vous ajoutez une modification (git add)</p>
						<img width="656" height="374" src="img/git-areas.png">

						<aside class="notes">
							Attention, c'est l'image au moment du 'add', cela ne suit pas spéficiquement les fichiers ajoutés
						</aside>
						
					</section>


					<section>
						<h2>Mais où est <strike>Waldo</strike> le serveur ?</h2>
						<img width="75" height="150" src="img/wheres-waldo.jpg" alt="Where's Waldo?">
					</section>

					<section>
						<h2>C'est un dépôt distant !</h2>
						<img width="328" src="img/distributed.png">
						<aside class="notes">
							C'est la notion de "serveur distribué" qui se cache derrière ce gestionnaire de version
						</aside>
					</section>
				</section>

				<section>
					<section>
						<h2>commit, branch et merge...</h2>
						<p>
							Git c'est chiant, mais c'est bien comme ça !
						</p>
						<aside class="notes">
						
						</aside>
					</section>
					<section>
						<h2>Une branche c'est quoi ?</h2>
						<p>
							Une divergence dans l'arbre des commits
							<img width="500" src="img/basic-branching-1.png">
						</p>
						
						<aside class="notes">
							Si on crée une branche à partir de 'master' par exemple et qu'on ajoute un commit dans cette branche, on crée une divergence.
							Dans ce cas simple, on peut imaginer un 'fast-forward' vers la branche qu'on vient de créer
						</aside>
					</section>
					<section>
						<h2>Un cas simple, le fast-forward</h2>
						<p>
							<img  width="300" src="img/back-future.jpg">
						</p>
						<p class="fragment">
						    <code>$ git pull</code> <br />Ou <br /><code>$ git fetch & git merge origin/2.1</code>
						</p>
						<aside class="notes">
						    
						</aside>
					</section>

                                        <section>
					    <h2>Un cas simple, le fast-forward</h2>
					    <p>
						<img  width="500" src="img/basic-branching-2.png">
					    </p>
					</section>
					<section>
						<h2>Ok mais un vrai merge c'est quoi ?</h2>
						<p>
							<img width="656" src="img/basic-merge-1.png">
						</p>
						<aside class="notes">
							
						</aside>
					</section>
					<section>
						<h2>Une réconciliation !</h2>
						<p>
							C'est la réconciliation des branches avec leur ancêtre commun <br />
							<img width="656" src="img/basic-merge-2.png">
						</p>

						<aside class="notes">
							
						</aside>
					</section>

					<section>
						<h2>Dans un nouveau commit</h2>
						<p>
							<img width="656" src="img/basic-merge-3.png">
						</p>
						
					</section>

					<section>
						<h2>En cas de conflit</h2>
						<h3>C'est à vous de créer ce commit !</h3>
						<p>
							<ol>
				              <li><code>git status</code> pour voir les conflits</li>
				              <li>Examen du 1er fichier conflictuel (<code>git mergetool</code>)</li>
				              <li>Arbitrage des conflits du fichier</li>
				              <li><code>git add</code> pour marquer le fichier comme résolu</li>
				              <li>S’il reste des fichiers conflictuels, retour en (2).</li>
				              <li>Sinon, finalisation avec <code>git commit</code>.</li>
				            </ol>
						</p>
						<aside class="notes">
							Ok, celle-là je l'ai repompée honteusement...
						</aside>
					</section>
					<section>
						<h2>Et un rebase c'est quoi ?</h2>
						<p>
							On repart d'une divergence
							<img width="656" src="img/basic-rebase-1.png">
						</p>
						<aside class="notes">
							
						</aside>
					</section>

					<section>
						<h2>Si on faisait un merge</h2>
						<p>
							<img width="656" src="img/basic-rebase-2.png">
						</p>
					</section>

					<section>
						<h2>Mais on ne merge pas</h2>
						<p>
							<pre><code>
$ git checkout experiment
$ git rebase master
							</code></pre>
							<img width="656" src="img/basic-rebase-3.png">
						</p>

						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>Et on peut 'fast-forward'</h2>
						<p>
							<pre><code>
$ git checkout master
$ git merge experiment
							</code></pre>
							<img width="656" src="img/basic-rebase-4.png">
						</p>

						<aside class="notes">

						</aside>
					</section>
					
				</section>
				<section>
					<section>
						<h2>Les choses sérieuses</h2>
						<h3>La vraie vie chez &lt;insert company name&gt; !</h3>
						<p>
							
						</p>

						<aside class="notes">

						</aside>
					</section>
					<section>
						<h2>On 'commit' quels fichiers ?</h2>
						<p>
							<ul>
								<li class="fragment">Les fichiers sources</li>
								<li class="fragment">Les fichiers definissant les dépendances</li>
								<li class="fragment">Les resources</li>
							</ul>
						</p>
						<h2 class="fragment">Mais pas !</h2>
						<p>
							<ul>
								<li class="fragment">Les binaires (beurk)</li>
								<li class="fragment">Les librairies (re-beurk)</li>
								<li class="fragment">Les fichiers de configuration (je me sens pas bien)</li>
								<li class="fragment">Les fichiers projet (enfin des fois mais beurk quand même)</li>
							</ul>
						</p>
						<aside class="notes">
						Pour les fichiers de configuration, on commite des exemples mais pas la configuration !
						</aside>
					</section>
					<section>
						<h2>On 'commit' comment ?</h2>
						<p>
							<ul>
								<li class="fragment">Souvent !</li>
								<li class="fragment">Atomiquement !</li>
								<li class="fragment">Et on met un joli message ! (la politesse quoi !)
									<ul>
										<li class="fragment">Avec un titre court mais explicite (pas de 'Divers' ou 'Correction de bug')</li>
										<li class="fragment">Avec le numéro du ticket le cas échéant (mais pas juste le numéro)</li>
										<li class="fragment">Un paragraphe de texte explicatif si besoin (après une ligne vide)</li>
									</ul>
								</li>
								<li class="fragment">Et des fois on push (mais moins souvent)</li>
							</ul>


						</p>
						<aside class="notes">
							Atomique pour pouvoir : Reporter un bug fix facilement et pour éviter de marquer des fichiers avec des messages de commit qui n'ont rien à voir
							Plus d'indication sur le contenu du message sur <a href="https://www.elcurator.net/articles/5708-how-to-write-a-git-commit-message"> ce joli billet</a>
						</aside>
					</section>
					<section>
						<h2>Oops !</h2>
						<p>
							Comment faire quand on a fait une boulette dans un commit ou dans une branche (non pushé) ?
							<ul>
								<li class="fragment">Pour corriger un message : <code>git commit --amend</code></li>
								<li class="fragment">Pour éditer ces changements avant un push : 
								<pre><code>
$ git lg @{u}..
$ git rebase -i @{u}
								</code></pre>
								Voir la super présentation de <a href="http://delicious-insights.com/talks/blend2014-git-protips/#/pushes-rebase-i">Christophe Porteneuve</a>
								</li>
								
							</ul>


						</p>
						<aside class="notes">
							Atomique pour pouvoir : Reporter un bug fix facilement et pour éviter de marquer des fichiers avec des messages de commit qui n'ont rien à voir
							Plus d'indication sur le contenu du message sur <a href="https://www.elcurator.net/articles/5708-how-to-write-a-git-commit-message"> ce joli billet</a>
						</aside>
					</section>

				</section>
				<section>
					<section>
						<h2>Quand est-ce qu'on...</h2>
						<h3 class="fragment">merge ?</h3>
						<p class="fragment">
							Quand on a fait des branches différentes qu'on veut réconcilier (feature/topic => master).  
						</p>
						<h3 class="fragment">rebase ?</h3>
						<p class="fragment">
							Quand on travaille sur une même branche à plusieurs.
						</p>

						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>NO MORE 'git pull'</h2>
						<p>enfin presque... mais vraiment pas souvent !</p>
						<p>
							On fait soit
							<pre><code>
$ git fetch
$ git rebase xxxx
							</code></pre>
							Soit
							<pre><code>
$ git fetch
$ git merge xxxx
							</code></pre>
						</p>
						<aside class="notes">
						Si on veut que ce principe fonctionne, on ne doit pas faire des pull mais soit on fait des fecth/rebase soit des fetch/merge.
						Mais on doit bien comprendre l'implication de ce choix
						</aside>
					</section>
				</section>
				<section>
					<section>
						<h2>Pour le quotidien</h2>
						<p>Ouais parce que c'est bien beau, mais je tape quoi comme commande moi ?</p>
						<aside class="notes">
						    Il faut bien sûr tout faire en ligne de commande pour exploiter git, mais pas de panique, c'est pas compliqué
						</aside>
					</section>

                                        <section>
					    <h2>Commit simple</h2>
					    
					    <p>
						<pre><code>
$ git add myfile.scala
$ git commit -m "fix the nasty bug"
						</code></pre>
					    </p>
		                            
					</section>

                                        <section>
					    <h2>On envoie sur le serveur</h2>
					    
					    <p>
						<pre><code>
$ git pull
$ git mergetool # if needed
$ git push
						</code></pre>
					    </p>
		                            
					</section>
                                        

                                        <section>
					    <h2>Oups ! I did it again</h2>
					    Si on identifie un commit dont on veut se débarasser
					    <p>
						<pre><code>
$ git revert ef8c762
						</code></pre>
					    </p>
		                            
					</section>

                                        <section>
					    <h2>stash, stash</h2>
					    Sauvegarder ses modifications dans un espace temporaire sans commit
					    <p>
						<pre><code>
$ git stash
$ git stash pop
						</code></pre>
					    </p>
		                            
					</section>

                                        
                                        
					<section>
						<h2>Recherche d'un historique</h2>
						<p>Pas de <code>git blame</code> mais :</p>
						<p>
							<pre><code>
$ git log
							</code></pre>
						</p>
						<p class="fragment">
							Et si je cherche dans une fonction en particulier
							<pre class="fragment"><code>
$ git log -L :ma_methode:path/vers/mon/fichier.php
							</code></pre>
						</p>

						<aside class="notes">
						Marche si vous êtes en git 2.0 et que vous utilisez un language avec des {} (type C)
						Et il y a des alias tout prêt dans la config git de réference sur gitlab
						</aside>
					</section>

					<section>
						<h2>Recherche d'une divergence</h2>
						<p><img height="150" src="img/Duff_logo.gif" ></p>
						<p>
							Recherche en ignorant les espaces
							<pre><code>
$ git diff -w
							</code></pre>
						</p>
						<p class="fragment">
							Et si je veux voir ce qui a été déjà ajouté à l'index
							<pre class="fragment"><code>
$ git diff --cached
							</code></pre>
						</p>
						<aside class="notes">
						</aside>
					</section>
					<section>
						<h2>rerere</h2>
						<h3>Reuse Recorded Resolution</h3>
						<p>
							Cela permet de résoudre un conflit et de pouvoir rejouer cette résolution !
						</p>
						<h3>Demo</h3>
						<aside class="notes">
							Cela est utile dans deux cas : 
							- lorsqu'on reporte un bug fix de branche en branche
							- lorsqu'on veut faire un control merge pas complet
						</aside>
					</section>
					<section>
						<h2>Recherche d'un commit</h2>
						<p>
							<pre><code>
$ git branch -a --contains 7c28d2e
							</code></pre>
						</p>
						<p>
							<ul>
								<li class="fragment">Pour voir si un fix a bien été reporté</li>
								<li class="fragment">Pour voir où un bug doit être corrigé</li>
							</ul>
						</p>
						
						<aside class="notes">
							
						</aside>
					</section>

					<section>
						<h2>Cherry picking</h2>

						<p>
							Pour appliquer un commit là où on se trouve et reporter un bug-fix facilement par exemple
							<pre><code>
$ git cherry-pick 7c28d2e
							</code></pre>
						</p>
						<aside class="notes">
							
						</aside>
					</section>

				</section>
				<section>
					<section>
						<h2>Divers</h2>
						<h3>Les petits plus si on a le temps</h3>
						<aside class="notes">

						</aside>
					</section>
					<section>
						<h2>Markdown</h2>
						<p>
							Documentation directement accessible dans gitlab : 
							<img src="img/markdown.png">
							<a href="https://gitlab.v3d.fr/server/equalone-portal/blob/2.1/docs.md">Exemple</a>
						</p>
						<aside class="notes">

						</aside>
					</section>
					<section>
						<h2>Un prompt utile</h2>
						<p>
							
							Pour <a href="https://github.com/olivierverdier/zsh-git-prompt ">zsh</a> ou <a href="https://github.com/magicmonty/bash-git-prompt">bash</a>
							<img src="img/prompt.png">
						</p>
						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>Automatisez !</h2>
						<p>
							Créer des alias et des scripts pour automatiser votre quotidien !
						</p>
						<p>
							Au minimum, documenter les pratiques (markdown dans gitlab, dropbox, wiki,...)
						</p>
						<aside class="notes">

						</aside>
					</section>

				</section>
				<section>
					<h2>Conclusion</h2>
					<p>
						Git c'est bien, mangez-en !
					</p>
					<aside class="notes">

					</aside>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>
                
                <script>
		 // More info https://github.com/hakimel/reveal.js#configuration
		 Reveal.initialize({
		     controls: true,
		     progress: true,
		     history: true,
		     center: true,
		     transition: 'slide', // none/fade/slide/convex/concave/zoom
		     // More info https://github.com/hakimel/reveal.js#dependencies
		     dependencies: [
			 { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
			 { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
			 { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
			 { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
			 { src: 'plugin/search/search.js', async: true },
			 { src: 'plugin/zoom-js/zoom.js', async: true },
			 { src: 'plugin/notes/notes.js', async: true }
		     ]
		 });
		</script>


	</body>
</html>
